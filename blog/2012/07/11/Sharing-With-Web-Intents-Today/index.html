<!DOCTYPE html>
<html>
  <head>
    <title>
      wesleyhales.com: Sharing Content with Web Intents
    </title>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="/stylesheets/global.css?v31" media="screen, print" rel="stylesheet" type="text/css">
    <link href="/blog.atom" rel="alternate" type="application/atom+xml">
    <script defer="defer" src="/js/modernizr.js" type="text/javascript"></script>
    <script src="//www.google-analytics.com/cx/api.js?experiment=0000001" type="text/javascript"></script>
    <script>
      var image_variations = [
        'original.png',
        'variation1.png',
        'variation2.png'
      ]
      
      // 2. Choose the Variation for the Visitor
      var variation = cxApi.chooseVariation();
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-1241000-10', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <header>
      <div class="header-box" onclick="window.location = 'http://wesleyhales.com'">
        <div class="logo-bold">wesleyhales<span>.com</span></div>
        <nav class="console">
          <ul id="menu">
            <li id="home">
              <a href="/index.html">Blog</a>
            </li>
            <li id="design">
              <a href="/design/?p=design">Projects</a>
            </li>
            <li id="projects">
              <a href="/contact/?p=contact">Me</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>
    <aside id="rightcol">
      <div class="shadow-helper">
        <div class="left-toolbar">
          <section class="tags">
            <header>
              <h2 class="tags-title">
                Upcoming Events
              </h2>
              <div class="upcoming-container">
                <a href="http://fluentconf.com/fluent2014/public/schedule/detail/32856" target="blank">
                  <img class="float-left" src="/images/icons/fluent2013_logo_reg.gif" width="150px">
                </a>
                <a href="http://devnexus.com/s/speakers" target="blank">
                  <img class="float-right" src="/images/icons/devnexus.png">
                </a>
              </div>
            </header>
          </section>
          <section class="clear recent-comments">
            <header>
              <div class="dsq-widget" id="recentcomments">
                <h2 class="dsq-widget-title">
                  Recent Comments
                </h2>
                <script src="http://wesleyhales.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=0&amp;avatar_size=24&amp;excerpt_length=200" type="text/javascript"></script>
              </div>
            </header>
          </section>
          <section class="tags">
            <header>
              <h2 class="tags-title">
                My Book
              </h2>
              <div class="book-container">
                <a href="http://www.amazon.com/HTML5-JavaScript-Apps-Wesley-Hales/dp/1449320511/">
                  <img src="/images/icons/mybook.png">
                </a>
              </div>
            </header>
          </section>
          <section class="tweets" style="margin: 20px 0 0 0;">
            <header>
              <a class="twitter-timeline" data-dnt="true" data-widget-id="276405487782739969" href="https://twitter.com/wesleyhales">Tweets by @wesleyhales</a>
              <script>
                !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
              </script>
            </header>
          </section>
        </div>
      </div>
    </aside>
    <div id="main">
      <div id="post-container">
        <div class="article-list">
          <div class="post_navigation">
            <div class="previous_post link">
              Previous:
              <a href="/blog/2012/06/08/Sniffing-IE9-while-in-compatibility-mode/">
                Sniffing IE9 features while in compatibility mode
              </a>
            </div>
            <div class="next_post link">
              Next:
              <a href="/blog/2012/07/19/HTML5-in-Atlanta/">
                HTML5 is Booming in Atlanta
              </a>
            </div>
            <div class="clearfix"></div>
          </div>
          <div class="post">
            <h2 class="title">
              Sharing Content with Web Intents
            </h2>
            <h3 class="date">
              11 July 2012
            </h3>
            <h4 class="tags">
              <a href="/blog/tags/web intents/">
                web intents
              </a>
              |
              <a href="/blog/tags/html5/">
                html5
              </a>
              |
              <a href="/blog/tags/share/">
                share
              </a>
              |
              <a href="/blog/tags/stats/">
                stats
              </a>
              |
            </h4>
            <div class="content">
              <br/>
              
              
              <h3>The Intent of Sharing</h3>
              
              
              <p>If you employ share buttons on your site, then you might already be aware of the increased load that comes with trying
              to make your content social. Allowing users to take action on your specific content and "share" it is a common task.
              Much like linking HTML documents together, we are now linking apps together that are capable of
               pushing content to a receiving service via the user. This action or intent of "sharing" content across different apps
               has recently been identified in a <a href="http://dvcs.w3.org/hg/web-intents/raw-file/tip/spec/Overview.html">W3C Editors Draft called Web Intents</a>.</p>
              
              <p>I recently took a job working on <a href="http://cnn.com">CNN.com</a> and I'm sure you can imagine that the weight and performance of social sharing is pretty serious 'round these parts.
              So I will break down the current state of sharing as it exists today, then jump into an examination of Web Intents.</p>
              
              <br/>
              
              
              <h3>Why do we need Web Intents? </h3>
              
              
              <p>In today's world of sharing we have limited options.
              (Note that the "share" intent is one of many. You can also edit, save, etc... but this article is focused on sharing)
              We are forced to pull a JavaScript file and load a share button dynamically for the user, or we can encode a query string that will
              be the input on a GET request to the provided share service.</p>
              
              <p>For this example, I've taken the most widely used social networks as an example. Each is linked to a simple HTML page that only contains
              their specific resources to display a share button for the given service:</p>
              
              <ul>
              <li><a href="/_examples/shares/twitter/">Twitter</a></li>
              <li><a href="/_examples/shares/google/">Google+</a></li>
              <li><a href="/_examples/shares/fb/">Facebook</a></li>
              <li><a href="/_examples/shares/linkedin/">LinkedIn</a></li>
              </ul>
              
              
              <p>First, I wanted a true measurement on all the resources and page load times without anything in the cache.
              So I cleared the browser cache and loaded a single test page (from the list above) for each share service provider. Here are the results:</p>
              
              <div id="container" class="max-width-100"></div>
              
              
              <p>I know... seems pretty crazy that Facebook would have 11 HTTP requests and a 135KB payload (after compress/GZIP) for a share/like button.
              <img src="/images/design/share-buttons/facebook.PNG" alt="Facebook resources" class="max-width-100 margin10">
              LinkedIn is delivering 80KB of stuff, Twitter comes in right at 40KB, and although Google only serves up 2KB of resources, the data is broken up over 10 HTTP requests.</p>
              
              <p>Keep in mind that we are on a desktop browser, so worrying about all the HTTP requests may be a little nonsensical. But, on a mobile
              browser this is definitely something you should be concerned about.
              The previous no-cache scenario is a unique, one time case for our users. And chances are, your user's browser may have already
              cached this content from another site using the same button resources.</p>
              
              <p>So, after we load all the resources for the first time, surely those will be better cached via local/sessionStorage and
              optimized for fast load times and modern browsers, right? WRONG!</p>
              
              <p>On page refresh we get the following results:</p>
              
              <div id="container2" class="max-width-100"></div>
              
              
              <p>Here we see that there are no files being cached outside of the browsers default capabilities. Render times are still staying fairly consistent with the previous times, with the exception of Twitter, which
              was cut down to more than half of it's no-cache onload time.
              HTTP requests remain mostly the same, and sizes are a little better, but LinkedIn is still chiming in at 45KB... on each page load/refresh.</p>
              
              <p>Lastly, when we click the share button for each provider, we get the following:</p>
              
              <div id="container3" class="max-width-100"></div>
              
              
              <p>Ok, so we see something interesting here. Google is the only one who did lazy loading! \o/ Thanks Google! The additional 2KB
              of downloaded content creates the Google+ UI on the fly, but at a cost of 29 HTTP requests. Yes, that's right, 29.
              I didn't look very closely as to why LinkedIn updates the parent DOM, but your page has been abused pretty badly at
              this point so it probably doesn't matter too much :)</p>
              
              <p>So with all of this data, we can clearly see that today's DIY sharing intents are raping our applications pretty hard. We have no idea what
              those resources are doing and they come at a high cost. Aside from the issues of resource weight, back doors, and inefficient architecture of sharing services, there are many other issues
               with the current ways we handle the sharing of data.</p>
              
              <br/>
              
              
              <h3>Alternatives</h3>
              
              
              <p>The best alternative that works across browsers today is a simple share URL. Throw in some kick ass, responsive <a href="http://gregoryloucas.github.com/Font-Awesome-More/#all-icons">font icons</a>
               and we have a performant way to share content. But there are still a few problems with this approach:</p>
              
              <ol>
              <li>We are faced with a potential list of
              social networks and options that our users may not even use or care about. We've all seen it before, it's the typical "share bar" found on most major
              news sites and blogs.</li>
              <li>We don't have any way of receiving a callback on whether the post/share was successful or not. The only way to get this data is through async analytics
              by emedding a unique identifier in the URL. Then hope the referrer surfaces in next months usage reports.</li>
              </ol>
              
              
              <p>Here are the corresponding share URLs from the providers analyzed above.</p>
              
              <ul>
              <li><a href="https://developer.linkedin.com/documents/share-linkedin">LinkedIn:</a> http://www.linkedin.com/shareArticle?mini=true&url={articleUrl}&title={articleTitle}&summary={articleSummary}&source={articleSource}</li>
              <li><a href="https://dev.twitter.com/docs/intents">Twitter:</a> https://twitter.com/intent/tweet?url={articleURL} <-- Notice the "/intent/"? We'll get to that in a bit.</li>
              <li><a href="https://dev.twitter.com/docs/intents">Facebook:</a> http://www.facebook.com/sharer.php?u={url to share}&t={title of content}</li>
              <li><a href="https://dev.twitter.com/docs/intents">Google+:</a> https://plus.google.com/share?url={articleURL}</li>
              </ul>
              
              
              <br/>
              
              
              <h3>Web Intents</h3>
              
              
              <p>If you're still struggling to wrap your head around Web Intents, you're not alone. I had to sit down and run through the latest <a href="http://intentlab-io12.appspot.com/">Google IO 2012 code exercises</a>, <a href="http://www.youtube.com/watch?v=O1YjdKh-rPg&amp;feature=player_embedded#!">videos</a>, and <a href="http://www.smartjava.org/content/html5-web-intents-share-information-between-web-apps">articles</a> on Web Intents to really see how it is currently implemented and what it takes to make it work. As of this writing, the only
              browser supporting the <code>WebKitIntent</code> api is, you guessed it, WebKit. This includes Chrome versions >= 19. But, even though the tag is supported, you must install
              a Chrome extension to actually fulfill the intent.</p>
              
              <p>Here we see what happens when I click a Web Intent enabled button for sharing an image. You can try it out <a href="/_examples/shares/intent/">here</a>.
              <img src="/images/design/webintent-pick.PNG" alt="web intent pick" class="max-width-100 margin10"></p>
              
              <p>At this point you are probably wondering: How do we get the dialogue to show up in teh browser? How can we register an application to handle this request?
              The plan is to allow web applications to register themselves through a provided JavaScript api or HTML tag when the specification is
              final. For now, we must use a Chrome extension.</p>
              
              <p>This is a section pulled from the manifest file in the extension I'm using.</p>
              
              <div class="full-width clear">
              <code>&#x000A;<pre>&#x000A;"intents": {&#x000A;      "http://webintents.org/save" : {&#x000A;      "type": ["image/jpg", "image/jpeg", "image/png", "image/gif"],&#x000A;      "title": "PicStore",&#x000A;      "path": "save.html",&#x000A;      "disposition": "inline"&#x000A;    },&#x000A;</pre></code>
              </div>
              
              
              <p>To put it simply, this is how you register an application (Chrome extension) to be used as a Web Intent today. By using the namespace
              defined on the first line "http://webintents.org/save", we can assign our intent to be handled by any app who has this namespace and accepts the supplied "type".
              The "path" is just another HTML file which is included in my extension and the code on that page will handle the intent.</p>
              
              <p>In our client application, where the intent originates from, we call the following code onclick to allow the user to choose an application
              to fulfill this intent.</p>
              
              <div class="full-width clear">
              <code><pre>&#x000A;function invoke() {&#x000A;    var intent = new WebKitIntent({&#x000A;        "action":"http://webintents.org/save",&#x000A;        "type":"image/*",&#x000A;        "suggestions":["http://webintents.org/save","http://webintents.org/pick"],&#x000A;        "data":location.href});&#x000A;&#x000A;    var onSuccess = function(data) { alert(data) };&#x000A;    var onError = function(data) { alert(data) };&#x000A;&#x000A;    window.navigator.webkitStartActivity(intent, onSuccess, onError);&#x000A;}&#x000A;</pre></code>
              </div>
              
              
              <p>Web Intents are a really good solution to the problems I mentioned in the first part of this article. I'm sure there are many kinks
              which will be ironed out in upcoming revisions to the spec, but overall it seems like a nice fit as we transition to the "browser as a platform"
              and find new ways of linking data and applications.
              As I said earlier, the plan is to allow any web application to register itself in the browser/UserAgent and I'm assuming some kind of user approval will go along with that.
              The proposed way of registering an application is with the <code>&lt;intent&gt;</code> tag:
              <code><pre>&#x000A;&lt;intent&#x000A;  action="http://webintents.org/share"&#x000A;  type="image/*"&#x000A;  href="share.html"&#x000A;  disposition="window|inline"&#x000A; /&gt;&#x000A;</pre></code>
              Until this is implemented across browsers, all we have is the Chrome Web Store and extensions to take advantage of this technology.
              Read more about the details of Web Intents <a href="http://webintents.org">here</a>.</p>
              
              <p>*Note - Twitter has made the best attempt at an early implementation of Web Intents. The best thing service providers can do today, is follow <a href="https://dev.twitter.com/docs/intents">Twitter's implementation</a>.</p>
              
              <p>For a full example on how to create a Web Intent Chrome extension, run through the examples in <a href="http://intentlab-io12.appspot.com/">this Google IO lab at #IO12</a>.
              Or you can try it out with Chrome 19+ and the simple demo I wrote <a href="/_examples/shares/intent/">here</a>.</p>
              
              <br/>
              
              
              <br/>
              
              
              <h3>Other references and good reads:</h3>
              
              
              <p><a href="http://benlog.com/articles/2012/02/09/a-simpler-webbier-approach-to-web-intents-or-activities/">Web Activities</a></p>
              
              <p><a href="http://tantek.com/2011/220/b1/web-actions-a-new-building-block">Web Actions</a></p>
              
              <p><a href="http://www.smartjava.org/content/html5-web-intents-share-information-between-web-apps">Dev article</a></p>
              
              <p><a href="https://plus.google.com/116171619992010691739/posts">+WebIntents</a></p>
              
              <p><a href="http://www.youtube.com/watch?v=O1YjdKh-rPg&feature=player_embedded#!">Intro video from Google IO 2012</a></p>
              
              <br/>
              
              
              <br/>
              
              
              <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" defer></script>
              
              
              <script src="http://code.highcharts.com/highcharts.js" defer></script>
              
              
              <script src="http://code.highcharts.com/modules/exporting.js" defer></script>
              
              
              <script src="/js/sharing-web-intents-charts.js" defer></script>
            </div>
            <div class="comments">
              
                          <div id="disqus_thread"></div>
                          <script type="text/javascript">
                          var disqus_shortname = 'wesleyhales';
                          var disqus_url = "http://www.wesleyhales.com/blog/2012/07/11/Sharing-With-Web-Intents-Today/";
                          var disqus_developer = null;
                          var disqus_identifier = null;
                          (function() {
                            var dsq = document.createElement("script"); dsq.type = "text/javascript"; dsq.async = true;
                            dsq.src = "http://wesleyhales.disqus.com/embed.js";
                            (document.getElementsByTagName("head")[0] || document.getElementsByTagName("body")[0]).appendChild(dsq);
                          })();
                          </script>
                          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript=wesleyhales">comments powered by Disqus.</a></noscript>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br class="clear">
    <script defer="defer" src="/js/site.js" type="text/javascript"></script>
    <img border="0" src="http://titan.d2ship.com/beacon.php?ss_ad_client=cacbdce0e986dc8e">
    <script>
      <!--
      var ss_ad_client = 'cacbdce0e986dc8e';
      (function() {
        var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
        s.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'titan.d2ship.com/pov.js';
        var t = document.getElementsByTagName('script')[0]; t.parentNode.insertBefore(s, t);
      })();
      //-->
    </script>
  </body>
</html>
