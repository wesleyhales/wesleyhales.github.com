<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" prefix="og: http://ogp.me/ns#" xmlns:og="http://ogp.me/ns#"><!--<![endif]-->

    <head>
                <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="author" content="">
        <meta name="keywords" content="awesome, definitely">
	
        <meta property="og:site_name" content="Wesley Hales">
        <meta property="og:title" content="Wesley Hales">
        <meta property="og:url" content="http://wesleyhales.com/blog/2006/12/18/using-facelets-taghandlers-and-adding-multiple-listeners">
        <meta property="og:description" content="">
    
        <meta property="og:type" content="article" />
        <meta property="og:article:author" content="" />
        <meta property="og:article:published_time" content="2006-12-18T00:00:00Z" />
    
        <meta name="generator" content="Hugo 0.16" />
        <title>Using Facelets TagHandlers and Adding multiple listeners &middot; Wesley Hales </title>
        <link rel="canonical" href="http://wesleyhales.com/" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="">
        <link rel="stylesheet" type='text/css' href="http://wesleyhales.com/css/main.css"/>
        <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300|Montserrat:700' rel='stylesheet' type='text/css'>
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
    </head>
<body>
<!--[if lt IE 7]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chrome/â€Ž">install Google Chrome</a> to experience this site.</p><![endif]-->

    <header id="site-header">
        <div class="container">
            <a href="http://wesleyhales.com/" alt="Wesley Hales"><h1 class="blog-title heading">Wesley Hales</h1></a>
            <p class="blog-description"></p>
        </div>
    </header>
<main class="content" role="main">
	<div class="container">
		<article class="old">
	<header class="post-header">
        <h3 class="p-post-title">Using Facelets TagHandlers and Adding multiple listeners</h3>
    </header>

    <section class="post-content">
        <p>
ComponentHandler, HtmlComponentHandler, or TagHandler. So I think I finally have a handle on what each of these are used for. Okay the first 2 are easy, HtmlComponentHandler extends ComponentHandler. But what is a MetaRuleset and what can it do for my components? It looks to mee like it is just a method binding passthrough for the component when you call <code>MetaRuleset.addRule(typeTagRule);</code>?
</p>
<p>
TagHandler ended up saving the day for me, and after spending hours/days trying to get the first 2 to do what I was wanting, this one took me like 5 minutes. I was trying to add a handler to a component which turned out to be the wrong thing to do in facelets. Now, All one has to do is declare a tag in the *taglib.xml file and point it to the new handler class (as explained on Facelets docs). 
</p>
<code>
<pre>
</span><a name="l41">    <span class="s2">&lt;</span><span class="s5">tag</span><span class="s2">&gt;</span><span class="s0"> 
</span></a><a name="l42">        <span class="s2">&lt;</span><span class="s5">tag-name</span><span class="s2">&gt;</span><span class="s6">sliderListener</span><span class="s2">&lt;/</span><span class="s5">tag-name</span><span class="s2">&gt;</span><span class="s0"> 
</span></a><a name="l43">        <span class="s2">&lt;</span><span class="s5">handler-class</span><span class="s2">&gt;</span><span class="s6">com.halesconsulting.web.jsf.handler.SliderTagHandler</span><span class="s2">&lt;/</span><span class="s5">handler-class</span><span class="s2">&gt;</span><span class="s0"> 
</span></a><a name="l44">    <span class="s2">&lt;/</span><span class="s5">tag</span><span class="s2">&gt;</span><span class="s0"> </a>
</pre>
</code>
<p>
Next is defining the required and not-required attributes for your tag in the class.
</p>
<code>
<pre>
</span></a><a name="l27">  <span class="s0">private final </span><span class="s1">TagAttribute test; 
</span></a><a name="l28">  <span class="s0">private final </span><span class="s1">TagAttribute var; </a></a>
</pre>
</code>
<code>
<pre>
</span></a><a name="l35">  <span class="s0">public </span><span class="s1">SliderTagHandler(TagConfig config) { 
</span></a><a name="l36">      <span class="s0">super</span><span class="s1">(config); 
</span></a><a name="l37"> 
</a><a name="l38">      <span class="s2">// helper method for getting a required attribute</span><span class="s1"> 
</span></a><a name="l39">      <span class="s0">this</span><span class="s1">.test = </span><span class="s0">this</span><span class="s1">.getRequiredAttribute(</span><span class="s4">"type"</span><span class="s1">); 

</span></a><a name="l40"> 
</a><a name="l41">      <span class="s2">// helper method</span><span class="s1"> 
</span></a><a name="l42">      <span class="s0">this</span><span class="s1">.var = </span><span class="s0">this</span><span class="s1">.getAttribute(</span><span class="s4">"var"</span><span class="s1">); 
</span></a><a name="l43">  } </a></a></a></a></a>
</pre>
</code>

<p>Next, in the apply method, I was able to get this tags parent component instance (just like in JSP component development where you call <code>UIComponentTag tag = UIComponentTag.getParentUIComponentTag(pageContext);</code> It took me a while to figure out where I needed to do this, but after this worked, you should have seen the excitement! Nothing like figuring shit out on your own when no documentation could be found on what you are trying to do!</p> 
<p>I had to add a HashMap to keep track of what listeners had already been added. Otherwise, each render added a new listener...</p>
<code>
<pre>
</a><a name="l45">  <span class="s2">/** 

</span></a><a name="l46">   * Threadsafe Method for controlling evaluation of 
</a><a name="l47">   * its child tags, represented by "nextHandler" 
</a><a name="l48">   */<span class="s1"> 
</span></a><a name="l49">  <span class="s0">public void </span><span class="s1">apply(FaceletContext ctx, UIComponent parent) </span><span class="s0">throws </span><span class="s1">IOException, FacesException, ELException { 
</span></a><a name="l50"> 
</a><a name="l51">      <span class="s0">boolean </span><span class="s1">b = </span><span class="s0">this</span><span class="s1">.test.getBoolean(ctx); 

</span></a><a name="l52"> 
</a><a name="l53">      <span class="s0">if </span><span class="s1">(!addedMap.containsKey(test.getValue())){ 
</span></a><a name="l54">          SliderSource sliderSource = (SliderSource)parent; 
</a><a name="l55">          SliderListener listener = createSliderListener(test.getValue()); 
</a><a name="l56">          addedMap.put(test.getValue(),<span class="s0">true</span><span class="s1">); 
</span></a><a name="l57">          sliderSource.addSliderListener(listener); 
</a><a name="l58">      } 
</a><a name="l59">       

</a><a name="l60">      <span class="s0">if </span><span class="s1">(</span><span class="s0">this</span><span class="s1">.var != </span><span class="s0">null</span><span class="s1">) { 
</span></a><a name="l61">          ctx.setAttribute(var.getValue(ctx), <span class="s0">new </span><span class="s1">Boolean(b)); 
</span></a><a name="l62">      } 
</a><a name="l63">      <span class="s0">if </span><span class="s1">(b) { 
</span></a><a name="l64">          <span class="s0">this</span><span class="s1">.nextHandler.apply(ctx, parent); 

</span></a><a name="l65">      } 
</a><a name="l66">  } </a>
</pre>
</code>
<p>I still need to do a little more digging on the details of the nextHandler stuff. But I was happy to get it working the "right way"</p> 

    </section>

    <hr>

    <footer class="post-footer">
        <section class="f-1">
            
            <section class="author">
                <p>Words by Wesley Hales</p>
            </section>
            
            
            <p class="f-post-time"><time datetime="2006-12-18T00:00:00Z">December 18, 2006</time></p>
        </section>
                        
        <section class="f-2">
            <section class="share">
                <span>Share:
                <a class="icon-twitter" href="http://twitter.com/share?text=Using%20Facelets%20TagHandlers%20and%20Adding%20multiple%20listeners&url=http%3a%2f%2fwesleyhales.com%2fblog%2f2006%2f12%2f18%2fusing-facelets-taghandlers-and-adding-multiple-listeners"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fwesleyhales.com%2fblog%2f2006%2f12%2f18%2fusing-facelets-taghandlers-and-adding-multiple-listeners"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http%3a%2f%2fwesleyhales.com%2fblog%2f2006%2f12%2f18%2fusing-facelets-taghandlers-and-adding-multiple-listeners"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="fa fa-google-plus"></i>
                </a>
                </span>
            </section>

            
            	<span class="f-post-tags"><i class="fa fa-tag"></i>
            	Java
            	</span>
            
        </section>
                
        <section id="comments">
            <div id="disqus_thread" class="post-comments"></div>
            <script type="text/javascript">
              if (window.location.hostname != "localhost") {
                var disqus_shortname = 'wesleyhales';
                (function() {
                  var dsq = document.createElement('script');
                  dsq.type = 'text/javascript';
                  dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
              }
            </script>
            <noscript>
              Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
            </noscript>
        </section>
                
    </footer>
</article>
	</div>
</main>
    <footer id="site-footer">
        <div class="container">
            <a href="http://wesleyhales.com/index.xml" title="Get the RSS feed"><span class="tooltip"><i class="fa fa-rss"></i></span></a>
            <section>&copy; Wesley Hales 2016 | All rights reserved</section>
        </div>
    </footer>

    <script type="text/javascript" src="http://wesleyhales.com/js/fittext.js"></script>
    <script type="text/javascript">
      $(".heading").fitText();
    </script>

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-1241000-10', 'auto');
        ga('send', 'pageview');

    </script>


</body>
</html>